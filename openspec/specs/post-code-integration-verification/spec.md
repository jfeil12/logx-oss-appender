# post-code-integration-verification Specification

## Purpose
定义代码完成后的统一集成验证门禁规则，确保本地与 CI 采用一致入口、一致判定，并提供可追溯且可复现的验证结论。

## Requirements
### Requirement: 编码完成后必须触发统一集成验证入口
在代码编写完成并准备进入提交流程时，系统 MUST 通过统一入口触发集成验证流程，且入口语义在本地与 CI 中 SHALL 保持一致。

#### Scenario: 开发者在本地触发验证门禁
- **WHEN** 开发者在代码完成后执行统一验证入口
- **THEN** 系统 MUST 按固定顺序执行验证流程（前置检查、集成验证、结果汇总）
- **AND** 系统 MUST 输出本次验证所使用的入口与执行摘要

#### Scenario: CI 流水线触发验证门禁
- **WHEN** CI 在合并前阶段触发统一验证入口
- **THEN** 系统 SHALL 执行与本地一致的验证语义与判定规则
- **AND** 系统 MUST 产出可审计的执行记录与结果摘要

### Requirement: 任一验证步骤失败必须阻断变更完成判定
集成验证流程中的任何关键步骤失败时，系统 MUST 立即将门禁判定为失败，并 SHALL 明确标记当前变更未达到完成条件。

#### Scenario: 执行过程中出现失败步骤
- **WHEN** 任一关键步骤返回失败结果或非零退出码
- **THEN** 系统 MUST 立即判定门禁失败
- **AND** 系统 MUST 输出失败步骤与原因定位信息
- **AND** 系统 SHALL 阻断将该变更标记为“已完成”

### Requirement: 验证结果必须可追溯与可复现
验证完成后，系统 MUST 输出可追溯的结果信息（执行范围、关键命令、通过/失败结论与日志定位），确保审查者能够复现判定过程。

#### Scenario: 验证流程执行结束
- **WHEN** 验证流程结束并生成结论
- **THEN** 系统 MUST 输出通过或失败的明确判定
- **AND** 系统 MUST 提供关键日志或报告路径用于复查
- **AND** 系统 SHALL 保证判定依据可被团队复现验证
